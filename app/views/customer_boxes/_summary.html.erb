<!-- filepath: /Users/joshua/Sites/switch-rails/app/views/customer_boxes/_summary.html.erb -->
<% if order.orderables.any? %>
  <h5>Items To Add To Your Box</h5>
  <table class="table box-summary-table" style="width: 100%;">
    <thead>
      <tr>
        <th style="width: 50%;">Item</th>
        <th style="width: 16.6%;">Quantity</th>
        <th style="width: 16.6%;">Price</th>
        <th style="width: 16.6%;">Subtotal</th>
      </tr>
    </thead>
    <tbody class="mb-4">
      <% order.orderables.each do |orderable| %>
        <tr>
          <td><%= orderable.variation.name %></td>
          <td class="center"><%= orderable.quantity %></td>
          <td class="center"><%= display_price(orderable.variation.amount) %></td>
          <td class="center"><%= display_price(orderable.quantity * orderable.variation.amount) %></td>
          <td>
            <span class="close">
              <%= form_with(url: remove_orderable_path(orderable), method: :post, data: { turbo_frame: "customer_box_summary" }) do |f| %>
                <%= f.submit "remove" %>
              <% end %>
            </span>          
          </td>
        </tr>
      <% end %>
    </tbody>
    <tfoot class="mt-4">
      <tr>
        <th colspan="3" class="text-right">Total</th>
        <th class="center"><%= display_price(order.orderables.sum { |o| o.quantity * o.variation.amount }) %></th>
      </tr>
    </tfoot>
  </table>
<% else %>
  <p>No items added yet.</p>
<% end %>